Arguments:
batch_size: 128
valid_ratio: 0.5
augmentations: True
pretrained: True
num_epochs: 30
train_strats: ['pgd']
visualise: False
epsilon_fgsm: 0.031
alpha_fgsm: 0.5
epsilon_pgd: 0.031
alpha_pgd: 0.0078
num_iter_pgd: 10
save_dir: /home/adeliev/uvadlc_practicals_2025/assignment3/part2/logs/q23_pgd_def
test_crossover_defense: True
Device: cuda
training_strategy: pgd
Loading model
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /scratch-local/adeliev.17585614/17585614/torch_cache/hub/checkpoints/resnet18-f37072fd.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 36%|███▌      | 16.1M/44.7M [00:00<00:00, 142MB/s]100%|██████████| 44.7M/44.7M [00:00<00:00, 243MB/s]
Loading data
Training model
Epoch 0/29
----------
train Loss: 2.1272 Acc: 0.2600
val Loss: 1.3569 Acc: 0.5021
Epoch 1/29
----------
train Loss: 1.6822 Acc: 0.3861
val Loss: 1.2087 Acc: 0.5527
Epoch 2/29
----------
train Loss: 1.5123 Acc: 0.4445
val Loss: 1.1007 Acc: 0.6031
Epoch 3/29
----------
train Loss: 1.4166 Acc: 0.4813
val Loss: 1.0463 Acc: 0.6117
Epoch 4/29
----------
train Loss: 1.3518 Acc: 0.5039
val Loss: 0.9866 Acc: 0.6414
Epoch 5/29
----------
train Loss: 1.2968 Acc: 0.5249
val Loss: 0.9307 Acc: 0.6527
Epoch 6/29
----------
train Loss: 1.2553 Acc: 0.5401
val Loss: 0.9057 Acc: 0.6607
Epoch 7/29
----------
train Loss: 1.2296 Acc: 0.5493
val Loss: 0.8839 Acc: 0.6682
Epoch 8/29
----------
train Loss: 1.2236 Acc: 0.5527
val Loss: 0.8875 Acc: 0.6689
Epoch 9/29
----------
train Loss: 1.2233 Acc: 0.5534
val Loss: 0.9129 Acc: 0.6613
Epoch 10/29
----------
train Loss: 1.2172 Acc: 0.5541
val Loss: 0.8852 Acc: 0.6760
Epoch 11/29
----------
train Loss: 1.2127 Acc: 0.5551
val Loss: 0.8924 Acc: 0.6668
Epoch 12/29
----------
train Loss: 1.2124 Acc: 0.5573
val Loss: 0.9037 Acc: 0.6633
Epoch 13/29
----------
train Loss: 1.2066 Acc: 0.5580
val Loss: 0.8827 Acc: 0.6703
Epoch 14/29
----------
train Loss: 1.2047 Acc: 0.5582
val Loss: 0.8696 Acc: 0.6813
Epoch 15/29
----------
train Loss: 1.2038 Acc: 0.5580
val Loss: 0.8811 Acc: 0.6793
Epoch 16/29
----------
train Loss: 1.2009 Acc: 0.5599
val Loss: 0.9016 Acc: 0.6693
Epoch 17/29
----------
train Loss: 1.2046 Acc: 0.5600
val Loss: 0.9224 Acc: 0.6582
Epoch 18/29
----------
train Loss: 1.2036 Acc: 0.5589
val Loss: 0.8924 Acc: 0.6609
Epoch 19/29
----------
train Loss: 1.2024 Acc: 0.5597
val Loss: 0.8760 Acc: 0.6703
Epoch 20/29
----------
train Loss: 1.2054 Acc: 0.5582
val Loss: 0.8984 Acc: 0.6695
Epoch 21/29
----------
train Loss: 1.2039 Acc: 0.5596
val Loss: 0.8945 Acc: 0.6658
Epoch 22/29
----------
train Loss: 1.2015 Acc: 0.5609
val Loss: 0.9170 Acc: 0.6592
Epoch 23/29
----------
train Loss: 1.2023 Acc: 0.5606
val Loss: 0.9017 Acc: 0.6633
Epoch 24/29
----------
train Loss: 1.2033 Acc: 0.5580
val Loss: 0.8872 Acc: 0.6648
Epoch 25/29
----------
train Loss: 1.2009 Acc: 0.5601
val Loss: 0.8649 Acc: 0.6766
Epoch 26/29
----------
train Loss: 1.1992 Acc: 0.5624
val Loss: 0.8896 Acc: 0.6713
Epoch 27/29
----------
train Loss: 1.2011 Acc: 0.5601
val Loss: 0.8727 Acc: 0.6764
Epoch 28/29
----------
train Loss: 1.2007 Acc: 0.5604
val Loss: 0.8808 Acc: 0.6686
Epoch 29/29
----------
train Loss: 1.2011 Acc: 0.5596
val Loss: 0.8906 Acc: 0.6605
Training complete in 16m 19s
Best val Acc: 0.681250
Testing model
Accuracy of the network on the test set: 69 %
Testing adversarial attacks
Attack fgsm, args: {'alpha': 0.5, 'epsilon': 0.031}
Test Accuracy = 2711 / 5000 = 0.5422
Attack pgd, args: {'alpha': 0.0078, 'epsilon': 0.031, 'num_iter': 10}
Test Accuracy = 2108 / 5000 = 0.4216
