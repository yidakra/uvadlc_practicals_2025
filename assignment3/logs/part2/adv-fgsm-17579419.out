Arguments:
batch_size: 128
valid_ratio: 0.5
augmentations: True
pretrained: True
num_epochs: 30
train_strats: ['fgsm']
visualise: False
epsilon_fgsm: 0.031
alpha_fgsm: 0.5
epsilon_pgd: 0.031
alpha_pgd: 0.0078
num_iter_pgd: 10
save_dir: /home/adeliev/uvadlc_practicals_2025/assignment3/part2/logs/fgsm_def
test_crossover_defense: True
Device: cuda
training_strategy: fgsm
Loading model
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /scratch-local/adeliev.17579419/17579419/torch_cache/hub/checkpoints/resnet18-f37072fd.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 72%|███████▏  | 32.1M/44.7M [00:00<00:00, 334MB/s]100%|██████████| 44.7M/44.7M [00:00<00:00, 374MB/s]
Loading data
Training model
Epoch 0/29
----------
train Loss: 1.9064 Acc: 0.4414
val Loss: 1.2347 Acc: 0.5418
Epoch 1/29
----------
train Loss: 1.5035 Acc: 0.5870
val Loss: 1.0683 Acc: 0.6123
Epoch 2/29
----------
train Loss: 1.3654 Acc: 0.6347
val Loss: 0.9718 Acc: 0.6471
Epoch 3/29
----------
train Loss: 1.2823 Acc: 0.6585
val Loss: 0.9155 Acc: 0.6736
Epoch 4/29
----------
train Loss: 1.2200 Acc: 0.6786
val Loss: 0.8729 Acc: 0.6873
Epoch 5/29
----------
train Loss: 1.1720 Acc: 0.6937
val Loss: 0.8512 Acc: 0.6990
Epoch 6/29
----------
train Loss: 1.1361 Acc: 0.7062
val Loss: 0.8273 Acc: 0.7055
Epoch 7/29
----------
train Loss: 1.1074 Acc: 0.7149
val Loss: 0.8174 Acc: 0.7102
Epoch 8/29
----------
train Loss: 1.1008 Acc: 0.7160
val Loss: 0.7796 Acc: 0.7123
Epoch 9/29
----------
train Loss: 1.0910 Acc: 0.7182
val Loss: 0.8046 Acc: 0.7107
Epoch 10/29
----------
train Loss: 1.0887 Acc: 0.7202
val Loss: 0.7975 Acc: 0.7125
Epoch 11/29
----------
train Loss: 1.0871 Acc: 0.7209
val Loss: 0.7824 Acc: 0.7125
Epoch 12/29
----------
train Loss: 1.0852 Acc: 0.7214
val Loss: 0.7894 Acc: 0.7154
Epoch 13/29
----------
train Loss: 1.0796 Acc: 0.7220
val Loss: 0.7669 Acc: 0.7164
Epoch 14/29
----------
train Loss: 1.0757 Acc: 0.7234
val Loss: 0.7852 Acc: 0.7160
Epoch 15/29
----------
train Loss: 1.0747 Acc: 0.7243
val Loss: 0.7712 Acc: 0.7168
Epoch 16/29
----------
train Loss: 1.0738 Acc: 0.7259
val Loss: 0.7893 Acc: 0.7154
Epoch 17/29
----------
train Loss: 1.0746 Acc: 0.7229
val Loss: 0.7751 Acc: 0.7154
Epoch 18/29
----------
train Loss: 1.0729 Acc: 0.7222
val Loss: 0.7774 Acc: 0.7178
Epoch 19/29
----------
train Loss: 1.0726 Acc: 0.7241
val Loss: 0.7986 Acc: 0.7158
Epoch 20/29
----------
train Loss: 1.0737 Acc: 0.7254
val Loss: 0.7759 Acc: 0.7160
Epoch 21/29
----------
train Loss: 1.0768 Acc: 0.7247
val Loss: 0.7765 Acc: 0.7164
Epoch 22/29
----------
train Loss: 1.0745 Acc: 0.7260
val Loss: 0.7876 Acc: 0.7148
Epoch 23/29
----------
train Loss: 1.0719 Acc: 0.7248
val Loss: 0.7990 Acc: 0.7121
Epoch 24/29
----------
train Loss: 1.0741 Acc: 0.7234
val Loss: 0.7902 Acc: 0.7145
Epoch 25/29
----------
train Loss: 1.0798 Acc: 0.7240
val Loss: 0.7630 Acc: 0.7162
Epoch 26/29
----------
train Loss: 1.0727 Acc: 0.7242
val Loss: 0.8048 Acc: 0.7098
Epoch 27/29
----------
train Loss: 1.0731 Acc: 0.7259
val Loss: 0.7772 Acc: 0.7162
Epoch 28/29
----------
train Loss: 1.0780 Acc: 0.7237
val Loss: 0.7754 Acc: 0.7186
Epoch 29/29
----------
train Loss: 1.0698 Acc: 0.7264
val Loss: 0.7868 Acc: 0.7158
Training complete in 4m 19s
Best val Acc: 0.718555
Testing model
Accuracy of the network on the test set: 72 %
Testing adversarial attacks
Attack fgsm, args: {'alpha': 0.5, 'epsilon': 0.031}
Test Accuracy = 2323 / 5000 = 0.4646
Attack pgd, args: {'alpha': 0.0078, 'epsilon': 0.031, 'num_iter': 10}
Test Accuracy = 1829 / 5000 = 0.3658
