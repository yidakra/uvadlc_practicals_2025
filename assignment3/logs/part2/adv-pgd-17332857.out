Arguments:
batch_size: 128
valid_ratio: 0.5
augmentations: True
pretrained: True
num_epochs: 30
train_strats: ['pgd']
visualise: False
epsilon_fgsm: 0.031
alpha_fgsm: 0.5
epsilon_pgd: 0.031
alpha_pgd: 0.0078
num_iter_pgd: 10
save_dir: /home/adeliev/uvadlc_practicals_2025/assignment3/part2/logs/pgd_def
test_crossover_defense: False
Device: cuda
training_strategy: pgd
Loading model
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /scratch-local/adeliev.17332857/17332857/torch_cache/hub/checkpoints/resnet18-f37072fd.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 72%|███████▏  | 32.4M/44.7M [00:00<00:00, 339MB/s]100%|██████████| 44.7M/44.7M [00:00<00:00, 357MB/s]
Loading data
Training model
Epoch 0/29
----------
train Loss: 2.1446 Acc: 0.2513
val Loss: 1.3921 Acc: 0.5031
Epoch 1/29
----------
train Loss: 1.6909 Acc: 0.3830
val Loss: 1.2371 Acc: 0.5520
Epoch 2/29
----------
train Loss: 1.5211 Acc: 0.4405
val Loss: 1.1198 Acc: 0.5855
Epoch 3/29
----------
train Loss: 1.4250 Acc: 0.4768
val Loss: 1.0466 Acc: 0.6113
Epoch 4/29
----------
train Loss: 1.3553 Acc: 0.5015
val Loss: 0.9721 Acc: 0.6408
Epoch 5/29
----------
train Loss: 1.3058 Acc: 0.5217
val Loss: 0.9719 Acc: 0.6424
Epoch 6/29
----------
train Loss: 1.2601 Acc: 0.5377
val Loss: 0.9781 Acc: 0.6367
Epoch 7/29
----------
train Loss: 1.2313 Acc: 0.5478
val Loss: 0.9157 Acc: 0.6660
Epoch 8/29
----------
train Loss: 1.2289 Acc: 0.5478
val Loss: 0.8939 Acc: 0.6725
Epoch 9/29
----------
train Loss: 1.2229 Acc: 0.5524
val Loss: 0.9135 Acc: 0.6621
Epoch 10/29
----------
train Loss: 1.2230 Acc: 0.5518
val Loss: 0.8895 Acc: 0.6691
Epoch 11/29
----------
train Loss: 1.2176 Acc: 0.5536
val Loss: 0.8796 Acc: 0.6729
Epoch 12/29
----------
train Loss: 1.2126 Acc: 0.5549
val Loss: 0.9068 Acc: 0.6660
Epoch 13/29
----------
train Loss: 1.2112 Acc: 0.5568
val Loss: 0.8682 Acc: 0.6785
Epoch 14/29
----------
train Loss: 1.2067 Acc: 0.5582
val Loss: 0.9010 Acc: 0.6658
Epoch 15/29
----------
train Loss: 1.2063 Acc: 0.5580
val Loss: 0.8786 Acc: 0.6758
Epoch 16/29
----------
train Loss: 1.2050 Acc: 0.5583
val Loss: 0.8914 Acc: 0.6668
Epoch 17/29
----------
train Loss: 1.2045 Acc: 0.5583
val Loss: 0.8897 Acc: 0.6676
Epoch 18/29
----------
train Loss: 1.2062 Acc: 0.5578
val Loss: 0.8863 Acc: 0.6721
Epoch 19/29
----------
train Loss: 1.2054 Acc: 0.5590
val Loss: 0.8692 Acc: 0.6729
Epoch 20/29
----------
train Loss: 1.2017 Acc: 0.5594
val Loss: 0.8966 Acc: 0.6734
Epoch 21/29
----------
train Loss: 1.2080 Acc: 0.5571
val Loss: 0.9058 Acc: 0.6686
Epoch 22/29
----------
train Loss: 1.2073 Acc: 0.5573
val Loss: 0.8972 Acc: 0.6639
Epoch 23/29
----------
train Loss: 1.2054 Acc: 0.5586
val Loss: 0.8858 Acc: 0.6742
Epoch 24/29
----------
train Loss: 1.2049 Acc: 0.5576
val Loss: 0.8855 Acc: 0.6750
Epoch 25/29
----------
train Loss: 1.2071 Acc: 0.5580
val Loss: 0.8836 Acc: 0.6656
Epoch 26/29
----------
train Loss: 1.2048 Acc: 0.5595
val Loss: 0.8926 Acc: 0.6645
Epoch 27/29
----------
train Loss: 1.2020 Acc: 0.5600
val Loss: 0.8715 Acc: 0.6801
Epoch 28/29
----------
train Loss: 1.2038 Acc: 0.5574
val Loss: 0.9009 Acc: 0.6721
Epoch 29/29
----------
train Loss: 1.2036 Acc: 0.5590
val Loss: 0.8787 Acc: 0.6713
Training complete in 16m 6s
Best val Acc: 0.680078
Testing model
Accuracy of the network on the test set: 69 %
Testing adversarial attacks
Attack pgd, args: {'alpha': 0.0078, 'epsilon': 0.031, 'num_iter': 10}
Test Accuracy = 2202 / 5000 = 0.4404
