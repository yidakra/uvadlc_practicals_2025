Arguments:
batch_size: 128
valid_ratio: 0.5
augmentations: True
pretrained: True
num_epochs: 30
train_strats: ['fgsm']
visualise: False
epsilon_fgsm: 0.031
alpha_fgsm: 0.5
epsilon_pgd: 0.031
alpha_pgd: 0.0078
num_iter_pgd: 10
save_dir: /home/adeliev/uvadlc_practicals_2025/assignment3/part2/logs/q23_fgsm_def
test_crossover_defense: True
Device: cuda
training_strategy: fgsm
Loading model
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /scratch-local/adeliev.17585495/17585495/torch_cache/hub/checkpoints/resnet18-f37072fd.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 94%|█████████▍| 42.0M/44.7M [00:00<00:00, 440MB/s]100%|██████████| 44.7M/44.7M [00:00<00:00, 444MB/s]
Loading data
Training model
Epoch 0/29
----------
train Loss: 1.8965 Acc: 0.4440
val Loss: 1.2290 Acc: 0.5551
Epoch 1/29
----------
train Loss: 1.5019 Acc: 0.5867
val Loss: 1.0736 Acc: 0.6146
Epoch 2/29
----------
train Loss: 1.3685 Acc: 0.6310
val Loss: 0.9718 Acc: 0.6457
Epoch 3/29
----------
train Loss: 1.2798 Acc: 0.6613
val Loss: 0.9157 Acc: 0.6754
Epoch 4/29
----------
train Loss: 1.2239 Acc: 0.6777
val Loss: 0.8484 Acc: 0.6939
Epoch 5/29
----------
train Loss: 1.1774 Acc: 0.6936
val Loss: 0.8226 Acc: 0.7021
Epoch 6/29
----------
train Loss: 1.1425 Acc: 0.7054
val Loss: 0.7812 Acc: 0.7076
Epoch 7/29
----------
train Loss: 1.1073 Acc: 0.7181
val Loss: 0.7921 Acc: 0.7123
Epoch 8/29
----------
train Loss: 1.1059 Acc: 0.7176
val Loss: 0.7780 Acc: 0.7086
Epoch 9/29
----------
train Loss: 1.1040 Acc: 0.7170
val Loss: 0.7881 Acc: 0.7123
Epoch 10/29
----------
train Loss: 1.0988 Acc: 0.7183
val Loss: 0.7886 Acc: 0.7127
Epoch 11/29
----------
train Loss: 1.0960 Acc: 0.7193
val Loss: 0.7824 Acc: 0.7158
Epoch 12/29
----------
train Loss: 1.0903 Acc: 0.7203
val Loss: 0.7667 Acc: 0.7172
Epoch 13/29
----------
train Loss: 1.0834 Acc: 0.7240
val Loss: 0.7747 Acc: 0.7170
Epoch 14/29
----------
train Loss: 1.0862 Acc: 0.7243
val Loss: 0.7808 Acc: 0.7156
Epoch 15/29
----------
train Loss: 1.0804 Acc: 0.7253
val Loss: 0.7679 Acc: 0.7145
Epoch 16/29
----------
train Loss: 1.0839 Acc: 0.7266
val Loss: 0.7716 Acc: 0.7180
Epoch 17/29
----------
train Loss: 1.0872 Acc: 0.7242
val Loss: 0.7564 Acc: 0.7164
Epoch 18/29
----------
train Loss: 1.0813 Acc: 0.7256
val Loss: 0.7786 Acc: 0.7170
Epoch 19/29
----------
train Loss: 1.0840 Acc: 0.7230
val Loss: 0.7606 Acc: 0.7174
Epoch 20/29
----------
train Loss: 1.0817 Acc: 0.7264
val Loss: 0.7727 Acc: 0.7174
Epoch 21/29
----------
train Loss: 1.0791 Acc: 0.7249
val Loss: 0.7634 Acc: 0.7168
Epoch 22/29
----------
train Loss: 1.0825 Acc: 0.7237
val Loss: 0.7802 Acc: 0.7174
Epoch 23/29
----------
train Loss: 1.0842 Acc: 0.7248
val Loss: 0.7571 Acc: 0.7188
Epoch 24/29
----------
train Loss: 1.0808 Acc: 0.7248
val Loss: 0.7769 Acc: 0.7180
Epoch 25/29
----------
train Loss: 1.0850 Acc: 0.7250
val Loss: 0.7756 Acc: 0.7168
Epoch 26/29
----------
train Loss: 1.0797 Acc: 0.7232
val Loss: 0.7645 Acc: 0.7168
Epoch 27/29
----------
train Loss: 1.0844 Acc: 0.7231
val Loss: 0.7625 Acc: 0.7139
Epoch 28/29
----------
train Loss: 1.0812 Acc: 0.7255
val Loss: 0.7750 Acc: 0.7168
Epoch 29/29
----------
train Loss: 1.0795 Acc: 0.7260
val Loss: 0.7838 Acc: 0.7168
Training complete in 4m 25s
Best val Acc: 0.718750
Testing model
Accuracy of the network on the test set: 71 %
Testing adversarial attacks
Attack fgsm, args: {'alpha': 0.5, 'epsilon': 0.031}
Test Accuracy = 2677 / 5000 = 0.5354
Attack pgd, args: {'alpha': 0.0078, 'epsilon': 0.031, 'num_iter': 10}
Test Accuracy = 1804 / 5000 = 0.3608
